(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{407:function(t,s,a){"use strict";a.r(s);var n=a(56),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"android-开源项目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#android-开源项目"}},[t._v("#")]),t._v(" Android 开源项目")]),t._v(" "),a("h2",{attrs:{id:"滴滴-dokit"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#滴滴-dokit"}},[t._v("#")]),t._v(" 滴滴 DoKit")]),t._v(" "),a("h3",{attrs:{id:"gradle-依赖"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gradle-依赖"}},[t._v("#")]),t._v(" "),a("a",{attrs:{href:"https://xingyun.xiaojukeji.com/docs/dokit/#/androidGuide?id=_1-gradle-%E4%BE%9D%E8%B5%96",target:"_blank",rel:"noopener noreferrer"}},[t._v("Gradle 依赖"),a("OutboundLink")],1)]),t._v(" "),a("div",{staticClass:"language-groovy extra-class"},[a("pre",{pre:!0,attrs:{class:"language-groovy"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//核心模块")]),t._v("\n\ndebugImplementation "),a("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"io.github.didi.dokit:dokitx:'),a("span",{pre:!0,attrs:{class:"token expression"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("$")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("lastversion"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v('"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//文件同步模块")]),t._v("\n\ndebugImplementation "),a("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"io.github.didi.dokit:dokitx-ft:'),a("span",{pre:!0,attrs:{class:"token expression"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("$")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("lastversion"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v('"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//一机多控模块")]),t._v("\n\ndebugImplementation "),a("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"io.github.didi.dokit:dokitx-mc:'),a("span",{pre:!0,attrs:{class:"token expression"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("$")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("lastversion"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v('"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//weex模块")]),t._v("\n\ndebugImplementation "),a("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"io.github.didi.dokit:dokitx-weex:'),a("span",{pre:!0,attrs:{class:"token expression"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("$")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("lastversion"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v('"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//no-op 模块")]),t._v("\n\nreleaseImplementation "),a("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"io.github.didi.dokit:dokitx-no-op:'),a("span",{pre:!0,attrs:{class:"token expression"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("$")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("lastversion"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v('"')]),t._v("\n\n")])])]),a("h3",{attrs:{id:"初始化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#初始化"}},[t._v("#")]),t._v(" 初始化")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("onCreate")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n   "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DoKit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Builder")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("productId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"需要使用平台功能的话，需要到dokit.cn平台申请id"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("build")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \n")])])]),a("h3",{attrs:{id:"流量监控以及其他aop功能-可选"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#流量监控以及其他aop功能-可选"}},[t._v("#")]),t._v(" "),a("a",{attrs:{href:"https://xingyun.xiaojukeji.com/docs/dokit/#/androidGuide?id=_3-%E6%B5%81%E9%87%8F%E7%9B%91%E6%8E%A7%E4%BB%A5%E5%8F%8A%E5%85%B6%E4%BB%96aop%E5%8A%9F%E8%83%BD%EF%BC%88%E5%8F%AF%E9%80%89%EF%BC%89",target:"_blank",rel:"noopener noreferrer"}},[t._v("流量监控以及其他AOP功能（可选）"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("AOP包括以下几个功能: 1)百度、腾讯、高德地图的经纬度模拟 2)UrlConnection、Okhttp 抓包以及后续的接口hook功能 3)App 启动耗时统计 4)慢函数 5)大图")]),t._v(" "),a("p",[t._v("在项目的 "),a("code",[t._v("build.gradle")]),t._v(" 中添加 classpath。")]),t._v(" "),a("div",{staticClass:"language-groovy extra-class"},[a("pre",{pre:!0,attrs:{class:"language-groovy"}},[a("code",[t._v("buildscript "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    dependencies "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        …\n        classpath "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'io.github.didi.dokit:dokitx-plugin:${lastversion}'")]),t._v("\n        …\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("在 app 的 "),a("code",[t._v("build.gradle")]),t._v(" 中添加 plugin。")]),t._v(" "),a("div",{staticClass:"language-groovy extra-class"},[a("pre",{pre:!0,attrs:{class:"language-groovy"}},[a("code",[t._v("apply plugin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'com.didi.dokit'")]),t._v("\n")])])]),a("p",[a("strong",[t._v("插件配置选项:")]),t._v(" 添加到app module 的build.gradle文件下 与android {}处于同一级")]),t._v(" "),a("div",{staticClass:"language-groovy extra-class"},[a("pre",{pre:!0,attrs:{class:"language-groovy"}},[a("code",[t._v("dokitExt "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//通用设置")]),t._v("\n    comm "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//地图经纬度开关")]),t._v("\n        gpsSwitch "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//网络开关")]),t._v("\n        networkSwitch "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//大图开关")]),t._v("\n        bigImgSwitch "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//webView js 抓包")]),t._v("\n        webViewSwitch "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    slowMethod "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//调用栈模式配置 对应gradle.properties中DOKIT_METHOD_STRATEGY=0")]),t._v("\n        stackMethod "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//默认值为 5ms 小于该值的函数在调用栈中不显示")]),t._v("\n            thresholdTime "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//调用栈函数入口 千万不要用我默认的配置 如果有特殊需求修改成项目中自己的入口 假如不需要可以去掉该字段")]),t._v("\n            enterMethods "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"com.example.myjetpack.base.App"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//            //黑名单 粒度最小到类 暂不支持到方法  千万不要用我默认的配置 如果有特殊需求修改成项目中自己的入口 假如不需要可\t\t\t\t以去掉该字段")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('//            methodBlacklist = ["com.facebook.drawee.backends.pipeline.Fresco"]')]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//普通模式配置 对应gradle.properties中DOKIT_METHOD_STRATEGY=1")]),t._v("\n        normalMethod "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//默认值为 500ms 小于该值的函数在运行时不会在控制台中被打印")]),t._v("\n            thresholdTime "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("500")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//需要针对函数插装的包名 千万不要用我默认的配置 如果有特殊需求修改成项目中自己的项目包名 假如不需要可以去掉该字\t\t\t\t段")]),t._v("\n            packageNames "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"com.example.myjetpack"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//不需要针对函数插装的包名&类名 千万不要用我默认的配置 如果有特殊需求修改成项目中自己的项目包名 假如不需要可以去\t\t\t\t掉该字段")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('//            methodBlacklist = ["com.didichuxing.doraemondemo.dokit"]')]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("p",[t._v("其中"),a("strong",[t._v("strategy")]),t._v("和"),a("strong",[t._v("methodSwitch")]),t._v("配置项已经弃用。新的配置开关位于项目根目录下的"),a("strong",[t._v("gradle.properties")]),t._v("中。")]),t._v(" "),a("p",[t._v("具体的配置如下所示：")]),t._v(" "),a("div",{staticClass:"language-groovy extra-class"},[a("pre",{pre:!0,attrs:{class:"language-groovy"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// dokit全局配置")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 插件开关")]),t._v("\nDOKIT_PLUGIN_SWITCH"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// DOKIT读取三方库会和booster冲突 如果你的项目中也集成了booster 建议将开关改成false")]),t._v("\nDOKIT_THIRD_LIB_SWITCH"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 插件日志")]),t._v("\nDOKIT_LOG_SWITCH"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 自定义Webview的全限定名 主要是作用于h5 js抓包和数据mock")]),t._v("\nDOKIT_WEBVIEW_CLASS_NAME"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("com"),a("span",{pre:!0,attrs:{class:"token string regex"}},[t._v("/didichuxing/")]),t._v("doraemonkit"),a("span",{pre:!0,attrs:{class:"token string regex"}},[t._v("/widget/")]),t._v("webview"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("MyWebView\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// dokit 慢函数开关")]),t._v("\nDOKIT_METHOD_SWITCH"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// dokit 函数调用栈层级")]),t._v("\nDOKIT_METHOD_STACK_LEVEL"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 0:默认模式 打印函数调用栈 需添加指定入口  默认为application onCreate 和attachBaseContext")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1:普通模式 运行时打印某个函数的耗时 全局业务代码函数插入")]),t._v("\nDOKIT_METHOD_STRATEGY"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);